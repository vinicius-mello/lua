-- test pdfsg library

local pdf=require"pdfsg"
print(pdf.version)

local L=400
local output="test.pdf"
local doc=pdf.newdoc(output):setinfo("/Producer ("..pdf.version..")")
local ft=doc:setfont("Times-Roman")
local fh=doc:setfont("Helvetica")
local p,g

p=doc:newpage(L,L,"glyph as text",0)
doc:translate(0,140)
   :setfill(0.0,0.0,0.4)
   :text("g",ft,512,0,0,0,0)
   :text("text",fh,24,L-80,0,0,0)

g=doc:newgroup()
doc:circle(L-50,-L/4,10)
   :fillstroke()
   :endgroup()
   :addgroup(p,g)

p=doc:newpage(L,L,"glyph as text both")
doc:translate(0,140)
   :setfill(0.8,0.8,0.8)
   :setstroke(1.0,0.0,0.0)
   :text("g",ft,512,0,0,0,2)
   :text("text mode",fh,24,L-120,0,0,1)
   :addgroup(p,g)

p=doc:newpage(L,L,"glyph as path")
doc:translate(0,140)
   :setfill(1.0,0.0,0.0)
   :text("path",fh,24,L-80,0,0,0)
   :setfill(0.8,0.8,0.8)
   :setstroke(1.0,0.0,0.0)
   :moveto(50.25,-46.25)
   :conicto(50.25,-67.25,73.875,-75.25)
   :conicto(97.5,-83.25,128.0,-83.25)
   :conicto(169.5,-83.25,195.5,-68.875)
   :conicto(221.5,-54.5,221.5,-33.5)
   :conicto(221.5,-16.75,200.5,-11.25)
   :conicto(187.5,-8.0,151.25,-7.5)
   :conicto(142.0,-7.25,131.75,-6.875)
   :conicto(121.5,-6.5,113.0,-6.0)
   :conicto(107.5,-5.75,95.25,-4.0)
   :conicto(83.0,-2.25,77.0,-1.0)
   :conicto(74.0,-1.0,62.25,-16.75)
   :conicto(50.25,-32.75,50.25,-46.25)
   :moveto(82.75,84.0)
   :conicto(60.0,91.5,47.375,110.75)
   :conicto(34.75,130.0,34.75,154.0)
   :conicto(34.75,183.25,58.0,209.5)
   :conicto(81.25,235.75,123.75,235.75)
   :conicto(142.0,235.75,164.0,227.125)
   :conicto(186.0,218.5,206.25,218.5)
   :conicto(211.5,218.5,222.125,218.875)
   :conicto(232.75,219.25,237.5,219.25)
   :lineto(240.5,219.25)
   :lineto(240.5,199.0)
   :lineto(197.25,199.0)
   :conicto(201.75,188.5,204.25,180.75)
   :conicto(208.5,166.25,208.5,153.25)
   :conicto(208.5,124.75,184.875,100.875)
   :conicto(161.25,77.0,121.25,77.0)
   :conicto(115.0,77.0,98.75,79.25)
   :conicto(91.5,79.25,79.625,67.0)
   :conicto(67.75,54.75,67.75,47.0)
   :conicto(67.75,39.0,85.25,35.25)
   :conicto(96.75,32.75,110.75,32.75)
   :conicto(175.0,32.75,198.0,25.5)
   :conicto(235.75,13.75,235.75,-25.0)
   :conicto(235.75,-64.5,191.625,-88.0)
   :conicto(147.5,-111.5,102.5,-111.5)
   :conicto(61.5,-111.5,37.5,-94.875)
   :conicto(13.5,-78.25,13.5,-60.0)
   :conicto(13.5,-51.0,19.875,-42.375)
   :conicto(26.25,-33.75,45.0,-16.75)
   :lineto(61.5,-2.0)
   :lineto(64.5,1.0)
   :conicto(53.0,5.5,47.25,9.75)
   :conicto(37.25,17.5,37.25,27.5)
   :conicto(37.25,36.75,45.875,47.875)
   :conicto(54.5,59.0,82.75,84.0)
   :moveto(130.25,89.0)
   :conicto(144.0,89.0,153.25,96.5)
   :conicto(168.25,108.5,168.25,138.25)
   :conicto(168.25,162.0,156.125,191.75)
   :conicto(144.0,221.5,115.75,221.5)
   :conicto(91.25,221.5,82.0,198.25)
   :conicto(77.25,186.0,77.25,168.0)
   :conicto(77.25,137.5,92.0,113.25)
   :conicto(106.75,89.0,130.25,89.0)
   :moveto(128.25,235.75)
   :lineto(128.25,235.75)
   :fillstroke()
   :addgroup(p,g)

p=doc:newpage(L,L,"transparency")
doc:translate(0,140)
   :setfill(0.0,0.0,0.4)
   :text("g",ft,512,0,0,0,0)
   :text("transparency",fh,24,L-150,0,0,0)
   :setfill(1.0,1.0,0.0)
   :setstroke(0.0,0.0,0.0)
   :setopacity(0.4)
   :circle(120,155,100)
   :fillstroke()
   :addgroup(p,g)

p=doc:newpage(L,L,"clipping")
doc:translate(0,140)
   :setfill(0.0,0.0,0.4)
   :text("g",ft,512,0,0,0,0)
   :text("clip",fh,24,L-80,0,0,0)
   :setfill(0.6,0.61,0.26)
   :save()
   :circle(120,155,100)
   :clip()
   :setfill(0.6,0.61,0.26)
   :text("g",ft,512,0,0,0,0)
   :restore()
   :addgroup(p,g)

doc:enddoc()
